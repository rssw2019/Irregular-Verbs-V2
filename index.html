<!-- Author: Ramjee Sharma -->
<!-- This page is publshed at -->
<!-- https://rssw2019.github.io/EnglishGrammar/ -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Irregular Verb V2 Quiz
    </title>
    <!-- <script src="irregular_verbs_questions.js"></script> -->
	<script src="irregular_verbs_v2_questions.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="time">
        <h2> </h2>
    </div>
    <div id="header">
        <h3>Irregular Verb V2 Quiz</h3>
    </div>
	 <div id="progress" style="text-align:left;">

    </div>
    <div id="score" style="text-align:right;">

    </div>

    <div id="feedback">

    

    </div>

   <div id="quizcontainer">
       <p> Welcome to the Irregular Verbs Quiz. Select the v2 (past) form of the given verbs. You can take this quiz multiple times.</p>
       <p><button onclick="quizGenerator()"><p>Begin the Quiz</p></button></p>
       

   </div> 

    </div>

    <div id="summary" style="background-color:orange;">

    <div id="restart">

    </div>


   <script>

       let quizTime=new Date();
       document.getElementById("time").innerHTML=`<p> Quiz Date:  ${quizTime}</p>`;
	   

        //Initial score

        let score=0;
        let percentage=0;
        let questionNumber=1;
        //let choiceArray=[1,2,3,4,5];

        
        maxQuestions=questions.length-1;
        minQuestions=0;
        counter=Math.floor(Math.random()*(maxQuestions-minQuestions)+minQuestions);
        console.log(counter);
        
        //Total number of questions for the quiz
        let totalQuestions=10;
        
        
       //Quiz generator function
       function quizGenerator(){
           //document.getElementById("score").innerHTML=``;
	   document.getElementById("feedback").innerHTML=``;
	       
	   //create random choice order
           let choiceOrder=[1,2,3,4,5];
                let max=questions[counter].choices.length-1;
                min=0;
                for (i=max;i>0;i--){            
                    const j=Math.floor(Math.random() * (i + 1));
                    const temp=choiceOrder[i];
                    choiceOrder[i]=choiceOrder[j];
                    choiceOrder[j]=temp;
                }
           
            for (let i=0;i<totalQuestions;i++){
		//write the progress
                document.getElementById("progress").innerHTML=`<p> ${questionNumber}/ ${totalQuestions} </p>`;

                //write the quesiton
		document.getElementById("quizcontainer").innerHTML=`<p>Q. Chose the V2 (past) form of the given verb. </p><p> &nbsp; &nbsp; &nbsp;${questions[counter].question}</p>`;

                //Write Answer choices
                //use .replace(/\s/g, '') to scrape all the white spaces inside the choice statements
                for (let j=0; j<questions[counter].choices.length;j++){
                    document.getElementById("quizcontainer").innerHTML+=` <input type="radio" id=${j} name= "my choice" value=${questions[counter].choices[choiceOrder[j]-1].trim().replace(/\s/g, '')}> ${questions[counter].choices[choiceOrder[j]-1].trim()} <br>`;
                }

                document.getElementById("quizcontainer").innerHTML+="<p><button onclick=\"answerChecker()\"> Submit</button></p>";  

            }
        }
    
    //answer Checker function
    function answerChecker(){
        let message="You did not select any answer.";
        for (let i=0;i<questions[counter].choices.length;i++){
            if(document.getElementById(i).checked) 
                {   
                    let selectedValue = document.getElementById(i).value.replace(/\s/g, ''); 
                    console.log(selectedValue.replace(/\s/g, '')); 
                    console.log(questions[counter].answer.replace(/\s/g, '')); 
                    if (selectedValue==questions[counter].answer.replace(/\s/g, ''))
                        {
                            score=score+1;
                            console.log(questionNumber);
                            message=`<p style="font-color:green;">Great! Your answer was correct. The v2(past) form of the verb ${questions[counter].question} is ${questions[counter].answer}.</p>`;  
                        }
                    else{
                        message=`<p>Oops! Your answer was not correct. The v2(past) form of the verb ${questions[counter].question} is ${questions[counter].answer}.</p>`;  
                    }
                }
                else{
                    //message="You did not choose any answer.";
                }
        }
        document.getElementById("feedback").innerHTML=message;  
        
        document.getElementById("score").innerHTML=`<p> Quiz Score: ${score} </p>`;
        if(questionNumber<totalQuestions){
            document.getElementById("quizcontainer").innerHTML=`<p><button onclick="quizGenerator()"> Next Question</p>`;  
            //update the question counter
            counter=counter+1;          
        }
        else{
            if(score>0.7*totalQuestions){
                document.getElementById("quizcontainer").innerHTML=`<p>Congratulations! You passed this quiz. Below is the summary of your result: <br>Number of correct answers = ${score} <br>Number of incorrect answers = ${totalQuestions-score}</p> <p> Refresh the browser if you want to take the quiz again.`;
            }
            else{
                document.getElementById("quizcontainer").innerHTML=`<p>You completed the quiz. Please study more and retake the quiz. Below is the summary of your result: <br>Number of correct answers = ${score} <br>Number of incorrect answers = ${totalQuestions-score}</p> <p> Refresh the browser to reake the quiz.`;
            }
            
            
            
            //reset the question counter=0
            counter=0;
            score=0;
        }
        //randomize the question counter
        counter=Math.floor(Math.random()*(100-1)+1);
        console.log(counter);
        questionNumber+=1;
    }

   </script>
</body>
